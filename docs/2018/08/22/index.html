<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.42.2" />

  <title>Sampling Methods &middot; </title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://liyuantong93.com/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://liyuantong93.com/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://liyuantong93.com/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/Ascetic.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://liyuantong93.com/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://liyuantong93.com/">Yuantong Li</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://liyuantong93.com/home/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://liyuantong93.com/post/"><i class='fa fa-institution fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://liyuantong93.com/publications/"><i class='fa fa-book fa-fw'></i>Publications</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/yuantongli" target="_blank"><i class="fa fa-linkedin-square fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/Likelyt" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2018 Yuantong Li. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Sampling Methods</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>22 Aug 2018</time>
  </div>

  

  
  
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://liyuantong93.com/tags/bayesian">Bayesian</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://liyuantong93.com/tags/computing">Computing</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://liyuantong93.com/tags/mcmc">MCMC</a>
    
  </div>
  
  

</div>

  <div id="inverse-of-cdf" class="section level2">
<h2>1. Inverse of CDF</h2>
<p>Inverse transform sampling is a method for generating random numbers from any probability distribution by using its inverse cumulative distribution <span class="math inline">\(F^{-1}(x)\)</span>. Recall that the cumulative distribution for a random variable X
is <span class="math inline">\(F_{X}(x)=P(X \leq x)\)</span>. A random variable <span class="math inline">\(U\)</span> uniformly distributed on <span class="math inline">\([0,1]\)</span>.</p>
<p>Step 1. Generate <span class="math inline">\(U \sim Unif(0,1)\)</span>.</p>
<p>Step 2. Let <span class="math inline">\(X = F^{-1}_{X}(U)\)</span>.</p>
<p>This method works when inverting <span class="math inline">\(F_{X}\)</span> is easy if <span class="math inline">\(X\)</span> is an exponential random variable, but its harder if <span class="math inline">\(X\)</span> is a Normal random variable. It works for discrete distributions.</p>
</div>
<div id="rejection-sampling" class="section level2">
<h2>2. Rejection Sampling</h2>
<p>The algorithm (used by John von Neumann and dating back to Buffon and his needle) to obtain a sample from distribution <span class="math inline">\(X\)</span> with density <span class="math inline">\(f\)</span> using samples from distribution <span class="math inline">\(Y\)</span> with density <span class="math inline">\(g\)</span> is as follows:</p>
<p>Step 1. Obtain a sample <span class="math inline">\(y\)</span> from distribution <span class="math inline">\(Y\)</span> and a sample<span class="math inline">\(u\)</span> from <span class="math inline">\(Unif(0,1)\)</span>.</p>
<p>Step 2. Check whether or not <span class="math inline">\(u \leq \frac{f(y)}{M\cdot g(y)}\)</span>:</p>
<ol style="list-style-type: lower-alpha">
<li><p>If this holds, accept <span class="math inline">\(y\)</span> as a sample draw from <span class="math inline">\(f\)</span>.</p></li>
<li><p>If not, reject the value of <span class="math inline">\(y\)</span> and return to the sampling step.</p></li>
</ol>
<p>The algorithm will take an average of <span class="math inline">\(M\)</span> iterations to obtain a sample. The main problem with this process is that <span class="math inline">\(M\)</span> is generally large in high-dimensional spaces and since <span class="math inline">\(f(accept) ∝ 1\)</span>, many samples will get rejected.</p>
</div>
<div id="importance-sampling" class="section level2">
<h2>3. Importance Sampling</h2>
<p>Our goal is to compute <span class="math inline">\(E(f) = \int f(x)p(x)dx\)</span>.</p>
<p>If we have a density <span class="math inline">\(q(x)\)</span> which is easy to sample from, we can sample <span class="math inline">\(x^{(i)} \sim q(x)\)</span>. Define the importance weight:</p>
<p><span class="math display">\[w(x^{(i)}) = \frac{p(x^{(i)})}{q(x^{(i)})}\]</span>
Consider the weighted Monte Carlo sum:</p>
<p><span class="math display">\[\frac{1}{N} \sum_{i=1}^{N} f(x^{(i)})w(x^{(i)}) = \int f(x)g(x)dx\]</span></p>
</div>
<div id="mcmc-method" class="section level2">
<h2>4. MCMC Method</h2>
<p>Metropolis–Hastings and other MCMC algorithms are generally used for sampling from multi-dimensional distributions, especially when the number of dimensions is high.</p>
<div id="m-h-sampling" class="section level3">
<h3>4.1 M-H Sampling</h3>
<p>In Metropolis-Hastings sampling, samples mostly move towards higher density regions, but sometimes also move downhill. In comparison to rejection sampling where we always throw away the rejected samples, here we sometimes keep those samples as well.</p>
<ol style="list-style-type: decimal">
<li><p>Init <span class="math inline">\(x^{(0)}\)</span></p></li>
<li><p>for <span class="math inline">\(i\)</span> = 0 to <span class="math inline">\(N-1\)</span> do:</p>
<p><span class="math inline">\(u \sim U(0,1)\)</span></p>
<p><span class="math inline">\(x^{\star} \sim q(x^{\star}|x^{(i)})\)</span></p>
<p>if <span class="math inline">\(u \leq \min \{1,\frac{p(x^{\star}) q(x^{(i)}|x^{(\star)})}{p(x^{(i)}) q(x^{\star}|x^{(i)})} \}\)</span> then,</p>
<p><span class="math inline">\(x^{(i+1)} \leftarrow x^{\star}\)</span></p>
<p>else</p>
<p><span class="math inline">\(x^{(i+1)} \rightarrow x^{(i)}\)</span></p>
<p>end if; end for</p></li>
</ol>
</div>
<div id="gibbs-sampling" class="section level3">
<h3>4.2 Gibbs Sampling</h3>
</div>
</div>
<div id="slice-sampling" class="section level2">
<h2>5. Slice Sampling</h2>
</div>
<div id="hamiltonian-monte-carlo" class="section level2">
<h2>6. Hamiltonian Monte Carlo</h2>
</div>
<div id="nested-sampling" class="section level2">
<h2>7. Nested Sampling</h2>
</div>
<div id="negative-sampling" class="section level2">
<h2>8. Negative Sampling</h2>
</div>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://liyuantong93.com/2018/08/20/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://liyuantong93.com/2018/08/20/">EM Algorithms</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://liyuantong93.com/2019/05/28/">Information Retrieval</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://liyuantong93.com/2019/05/28/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  

</div>

</div>
</div>
<script src="https://liyuantong93.com/js/ui.js"></script>






</body>
</html>

